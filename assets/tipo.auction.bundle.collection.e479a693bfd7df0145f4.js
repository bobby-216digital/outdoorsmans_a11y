(self.webpackChunktipoAuction=self.webpackChunktipoAuction||[]).push([[137],{7921:(t,i,e)=>{"use strict";e.r(i),e.d(i,{default:()=>m});var n=e(4132),o=e(3913),l=e(3949),s=e(4642),r=e(4412),a=e(1264),u=e(2586),c=e(3715),d=function(){return(d=Object.assign||function(t){for(var i,e=1,n=arguments.length;e<n;e++)for(var o in i=arguments[e])Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o]);return t}).apply(this,arguments)},v=function(t,i,e,n){return new(e||(e=Promise))((function(o,l){function s(t){try{a(n.next(t))}catch(t){l(t)}}function r(t){try{a(n.throw(t))}catch(t){l(t)}}function a(t){var i;t.done?o(t.value):(i=t.value,i instanceof e?i:new e((function(t){t(i)}))).then(s,r)}a((n=n.apply(t,i||[])).next())}))},p=function(t,i){var e,n,o,l,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return l={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function r(l){return function(r){return function(l){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return s.label++,{value:l[1],done:!1};case 5:s.label++,n=l[1],l=[0];continue;case 7:l=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){s=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){s.label=l[1];break}if(6===l[0]&&s.label<o[1]){s.label=o[1],o=l;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(l);break}o[2]&&s.ops.pop(),s.trys.pop();continue}l=i.call(t,s)}catch(t){l=[6,t],n=0}finally{e=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,r])}}},h=e(751),f=e(7079);const m={buildWidgetCollection:function(){var t,i,e,n;return v(this,void 0,void 0,(function(){var o,s,r,a,u,c,h,f,m,g,y,b,_,w,A,S,L,I=this;return p(this,(function(C){switch(C.label){case 0:return o=document.querySelectorAll('a[href*="/products/"]'),s=document.querySelectorAll(".tipo-auction-collection"),(null==this?void 0:this.AuctionCollectionsProducts)||(this.AuctionCollectionsProducts=new Array),(null==this?void 0:this.ObjectCollections)||(this.ObjectCollections=new Array),(null==this?void 0:this.AuctionSummaries)||(this.AuctionSummaries=new Array),(null==this?void 0:this.tpaIntervalIds)||(this.tpaIntervalIds=new Array),"product"!=this.page?[3,10]:document.querySelector(null===(n=null===(e=null===(i=null===(t=this.shop)||void 0===t?void 0:t.settings)||void 0===i?void 0:i.general)||void 0===e?void 0:e.selector)||void 0===n?void 0:n.custom_class_boxRelatedProduct)?(r=document.querySelector(this.shop.settings.general.selector.custom_class_boxRelatedProduct).querySelectorAll('a[href*="/products/"]'),a=document.querySelector(this.shop.settings.general.selector.custom_class_boxRelatedProduct).querySelectorAll(".tipo-auction-collection"),(null==r?void 0:r.length)||(null==this?void 0:this.Collections)?void 0!==(null==this?void 0:this.Collections)&&(null==this?void 0:this.Collections)?[4,this.getCollectionIds(a)]:[3,4]:[2,!1]):[3,8];case 1:return(u=C.sent())?[4,this.getSummaries(a,!1,u)]:[3,3];case 2:c=C.sent(),this.ObjectCollections=u,(null==c?void 0:c.histories)&&(this.AuctionSummaries=null==c?void 0:c.histories,a.forEach((function(t){return v(I,void 0,void 0,(function(){var i,e,n,o,s;return p(this,(function(r){switch(r.label){case 0:return(i=t.getAttribute("data-id"))?(e=null==this?void 0:this.Collections[i],n=u.find((function(t){return t.id==i})),(o=(0,l.Ai)(d(d({},e),{collections:null==n?void 0:n.collections}),null===(s=this.shop)||void 0===s?void 0:s.pennies,this.auctions))?[4,this.updateWidgetCollection(o,e,i,t,null==c?void 0:c.histories)]:[3,2]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))})),this.initSocketCollection(),this.initWidgetCollection()),C.label=3;case 3:return clearInterval(this.intervalProductPage),[3,7];case 4:return[4,this.getCollectionIds(!1,r)];case 5:return h=C.sent(),this.ObjectCollections=h,h?[4,this.getSummaries(!1,r,h)]:[3,7];case 6:(null==(f=C.sent())?void 0:f.histories)&&((g=document.createElement("DIV")).classList.add("tpa-toast-wrapper"),g.innerHTML='<div class="tpa-auction-message"></div>',this.ToastWidget=g,y=document.querySelector("body"),(b=y.querySelector(".tpa-toast-wrapper"))&&b.remove(),document.querySelector("body").appendChild(this.ToastWidget),this.ToastWidget=document.querySelector(".tpa-toast-wrapper"),this.AuctionSummaries=null==f?void 0:f.histories,m=new Array,r.forEach((function(t){return v(I,void 0,void 0,(function(){var i,e,n,o,s,r;return p(this,(function(a){switch(a.label){case 0:return i=t.href,void 0!==(e=(e=i.split("/products/")[1]).split("?")[0])&&e&&-1===m.indexOf(e)?(m.push(e),(n=h.find((function(t){return t.handle==e})))?(o=n.id,(s=(0,l.Ai)(d(d({},n),{collections:null==n?void 0:n.collections}),null===(r=this.shop)||void 0===r?void 0:r.pennies,this.auctions))?[4,this.updateWidgetCollection(s,n,o,t,null==f?void 0:f.histories,!0)]:[3,2]):[3,2]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))})),this.initSocketCollection(),this.initWidgetCollection(),clearInterval(this.intervalProductPage)),C.label=7;case 7:return[3,9];case 8:clearInterval(this.intervalProductPage),C.label=9;case 9:return[3,17];case 10:return(g=document.createElement("DIV")).classList.add("tpa-toast-wrapper"),g.innerHTML='<div class="tpa-auction-message"></div>',this.ToastWidget=g,y=document.querySelector("body"),(b=y.querySelector(".tpa-toast-wrapper"))&&b.remove(),document.querySelector("body").appendChild(this.ToastWidget),this.ToastWidget=document.querySelector(".tpa-toast-wrapper"),void 0!==(null==this?void 0:this.Collections)&&(null==this?void 0:this.Collections)?[4,this.getCollectionIds(s)]:[3,14];case 11:return(_=C.sent())?[4,this.getSummaries(s,!1,_)]:[3,13];case 12:w=C.sent(),this.ObjectCollections=_,(null==w?void 0:w.histories)&&(this.AuctionSummaries=null==w?void 0:w.histories,s.forEach((function(t){return v(I,void 0,void 0,(function(){var i,e,n,o,s;return p(this,(function(r){switch(r.label){case 0:return(i=t.getAttribute("data-id"))?(e=null==this?void 0:this.Collections[i],n=_.find((function(t){return t.id==i})),(o=(0,l.Ai)(d(d({},e),{collections:null==n?void 0:n.collections}),null===(s=this.shop)||void 0===s?void 0:s.pennies,this.auctions))?[4,this.updateWidgetCollection(o,e,i,t,null==w?void 0:w.histories)]:[3,2]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))})),this.initSocketCollection(),this.initWidgetCollection()),C.label=13;case 13:return[3,17];case 14:return o?[4,this.getCollectionIds(!1,o)]:[3,17];case 15:return A=C.sent(),this.ObjectCollections=A,A?[4,this.getSummaries(!1,o,A)]:[3,17];case 16:(null==(S=C.sent())?void 0:S.histories)&&(this.AuctionSummaries=null==S?void 0:S.histories,L=new Array,o.forEach((function(t){return v(I,void 0,void 0,(function(){var i,e,n,o,s,r;return p(this,(function(a){switch(a.label){case 0:return i=t.href,void 0!==(e=i.split("/products/")[1])&&e&&-1===L.indexOf(e)?(L.push(e),(n=A.find((function(t){return t.handle==e})))?(o=n.id,(s=(0,l.Ai)(d(d({},n),{collections:null==n?void 0:n.collections}),null===(r=this.shop)||void 0===r?void 0:r.pennies,this.auctions))?[4,this.updateWidgetCollection(s,n,o,t,null==S?void 0:S.histories,!0)]:[3,2]):[3,2]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))})),this.initSocketCollection(),this.initWidgetCollection()),C.label=17;case 17:return[2]}}))}))},updateWidgetCollection:function(t,i,e,s,r,a){var u,c,h,m,g,y,b,_,w,A,S,L,I,C,x,q,P,T,k,M,B,E,W,O,F,H,j,V,D,R,Z,N,z,G,Y,J,U,K,Q,X,$,tt,it,et,nt,ot,lt,st,rt,at,ut,ct,dt,vt,pt,ht,ft,mt;return v(this,void 0,void 0,(function(){var v,gt,yt,bt,_t,wt,At,St,Lt,It,Ct,xt,qt,Pt,Tt=this;return p(this,(function(p){return(null===(u=null==this?void 0:this.AuctionCollectionsProducts)||void 0===u?void 0:u.length)>0?this.AuctionCollectionsProducts.forEach((function(i){e&&(null==i?void 0:i.productId)!=e&&Tt.AuctionCollectionsProducts.push(d(d({},t),{productId:e}))})):this.AuctionCollectionsProducts.push(d(d({},t),{productId:e})),v=!1,gt=!1,yt=!1,bt='\n{{@if(it.status == 2 && it.settings?.general?.collection?.badge)}}\n  <span class="tpa-badge tpa-label--pending--auction">{{\'pendingAuction\' | translate}}</span>\n{{/if}}\n\n{{@if(it.status == 1 && it.settings?.general?.collection?.badge)}}\n  <span class="tpa-badge tpa-label--auction-status-bidPrice {{@if(it.summary?.numberBids && parseFloat(it.summary.currentAmount) > 0 && it.customer?.id && it.summary.customer_id != it.customer?.id)}}  __outbid{{#elif(it.summary?.numberBids && parseFloat(it.summary.currentAmount) > 0 && it.customer?.id && it.summary.customer_id == it.customer?.id)}} __Leading{{/if}}">\n    {{@if(it.summary.winnerAuction)}}\n      {{@if(it.summary.winnerCustomer == it.customer?.id)}}\n        {{\'Outbid\' | translate}}\n      {{#elif(parseFloat(it.summary.numberBids) > 0)}}\n        {{\'Leading\' | translate}}\n      {{/if}}\n    {{#else}}\n      {{@if(parseFloat(it.summary.currentAmount) > 0 && it.customer?.id && it.summary.customer_id != it.customer?.id)}}\n        {{\'Outbid\' | translate}}\n      {{#elif(parseFloat(it.summary.currentAmount) > 0 && it.customer?.id && it.summary.customer_id == it.customer?.id)}}\n        {{\'Leading\' | translate}}\n      {{/if}}\n    {{/if}}\n  </span> \n{{/if}}\n\n<div class="tpa-collection-widget__info">\n  <div class="tpa-collection-widget__other-info">\n    <div class="tpa-other-info">\n      {{@if(it.settings?.general?.collection?.highestPrice)}}\n        <div class="tpa-row tpa-other-info__start_price">\n          {{@if (it.status == 0) }}\n            {{@if (it.summary.currentAmount) }}\n              <div class="tpa-row__label tpa-text tpa-text--small tpa-text--grey tpa-text--uppercase">\n                {{\'finalBid\' | translate}}\n              </div>\n              <div class="tpa-row__value tpa-text tpa-text--bold">\n                {{it.summary.currentAmount*100 | money}}\n              </div>\n            {{/if}}\n          {{#else}}\n            {{@if (it.summary.currentAmount) }}\n              <div class="tpa-row__label tpa-text tpa-text--small tpa-text--grey tpa-text--uppercase">\n                {{\'currentBid\' | translate}}\n              </div>\n              <div class="tpa-row__value tpa-text tpa-text--bold">\n                {{it.summary.currentAmount*100 | money}}\n              </div>\n            {{#else}}\n              <div class="tpa-row__label tpa-text tpa-text--small tpa-text--grey tpa-text--uppercase">{{\'startingBid\' | translate}}</div>\n              <div class="tpa-row__value tpa-text tpa-text--bold">\n                {{it.profileConfig.startPrice*100 | money}}\n              </div>\n            {{/if}}\n          {{/if}}\n        </div>\n      {{/if}}\n    </div>\n  </div>\n\n  {{@if (it.status == 1 && it.settings?.general?.collection?.actionBid) }}\n    <div class="tpa-collection-widget__action-group">\n      <div>\n        <div class="tpa-action live-bid">\n          <div class="tpa-your_bid">\n            <div class="tpa-bid_price_wrapper">\n              <input class="tpa-text tpa-auction-amount" value="{{@if (it.summary.currentAmount) }}{{(it.summary.currentAmount+parseFloat(it.profileConfig.increment)) * 100 | money(null,true)}}{{#else}}{{ it.profileConfig.startPrice * 100 | money(null,true)}}{{/if}}" />\n              <span class="tpa-control">\n                <span class="tpa-text tpa-increment-button tpa-plus-amount">\n                  <svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path d="M24 10h-10v-10h-4v10h-10v4h10v10h4v-10h10z"/></svg>\n                </span>\n                <span class="tpa-text tpa-increment-button tpa-minus-amount">\n                  <svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 24 24"><path d="M0 10h24v4h-24z"/></svg>\n                </span>\n              </span>\n            </div>\n          </div>\n          <div class="tpa-auction-bid">\n            <button class="tpa-button tpa-text--bold tpa-button--primary tpa-text--white tpa-text--nowrap">\n              <span class="tpa-button-text">{{\'placeBid\' | translate}}</span>\n              <span class="tpa-button-loading">\n              </span>\n            </button>\n          </div>\n        </div>\n        <div class="tpa-auction-amount-note">\n          <div class="tpa-text tpa-text--small tpa-text--grey"> {{\'nextMinimumBid\' | translate}} <span class="tpa-auction-amount-note-price">{{@if (it.summary.currentAmount) }}{{((it.summary.currentAmount+parseFloat(it.profileConfig.increment)) * 100) | money}}{{#else}}{{it.profileConfig.startPrice * 100 | money}}{{/if}}</span> </div>\n        </div>\n      </div>\n    </div>\n  {{/if}}\n  <div class="tpa-remaining">\n    {{@if (it.status != 0) }}\n      {{@if(it.settings.general.countdown == \'textClock\')}}\n        <div class="tpa-remaining__text">\n          <div class="tpa-text">\n            <div class="tpa-remaining__text__label  tpa-text--small tpa-text--grey">\n              {{@if(it.status == 1)}}\n                {{\'closeAt\' | translate}}\n              {{#else}}\n                {{\'openForBidsIn\' | translate}}\n              {{/if}}\n            </div>\n            <span class="tpa-remaining__text__block tpa-text--bold ">\n              {{@if(it.status == 1)}}\n                {{* it.endAt | countdown }}\n              {{#else}}\n                {{* it.start_at | countdown }}\n              {{/if}}\n            </span>\n          </div>\n        </div>\n      {{#else}}\n        <div class="tpa-remaining__text__label tpa-text tpa-text--center tpa-text--small tpa-text--grey">\n        {{@if(it.status == 1)}}\n          {{\'closeAt\' | translate}}\n        {{#else}}\n          {{\'openForBidsIn\' | translate}}\n        {{/if}}\n        </div>\n        <div class="tpa-remaining__flipClock  tpa-x160">\n          <div class="clock"></div>\n        </div>\n      {{/if}}\n    {{#else}}\n      <div class="tpa-remaining__text__label tpa-text tpa-text--small tpa-text--grey">\n        {{\'closedForBidding\' | translate}}\n      </div>\n    {{/if}}\n  </div>\n</div>\n',_t=(0,l.PY)(i,t),(wt=null==r?void 0:r.find((function(i){return(null==i?void 0:i.product_id)==e&&(null==i?void 0:i.auction_id)==t.id})))||(wt={currentAmount:0,autoBidAmount:0,winnerAuction:!1,numberOfBids:0,numberBids:0,autoBid:!1}),0==_t?((null===(m=null===(h=null===(c=this.shop.settings)||void 0===c?void 0:c.general)||void 0===h?void 0:h.hide)||void 0===m?void 0:m.addToCart.includes("expired"))&&(v=!0),(null===(b=null===(y=null===(g=this.shop.settings)||void 0===g?void 0:g.general)||void 0===y?void 0:y.hide)||void 0===b?void 0:b.price.includes("expired"))&&(gt=!0),(null===(A=null===(w=null===(_=this.shop.settings)||void 0===_?void 0:_.general)||void 0===w?void 0:w.hide)||void 0===A?void 0:A.additionalPaymentButton.includes("expired"))&&(yt=!0)):1==_t?((null===(I=null===(L=null===(S=this.shop.settings)||void 0===S?void 0:S.general)||void 0===L?void 0:L.hide)||void 0===I?void 0:I.addToCart.includes("live"))&&(v=!0),(null===(q=null===(x=null===(C=this.shop.settings)||void 0===C?void 0:C.general)||void 0===x?void 0:x.hide)||void 0===q?void 0:q.price.includes("live"))&&(gt=!0),(null===(k=null===(T=null===(P=this.shop.settings)||void 0===P?void 0:P.general)||void 0===T?void 0:T.hide)||void 0===k?void 0:k.additionalPaymentButton.includes("live"))&&(yt=!0)):2==_t&&((null===(E=null===(B=null===(M=this.shop.settings)||void 0===M?void 0:M.general)||void 0===B?void 0:B.hide)||void 0===E?void 0:E.addToCart.includes("scheduled"))&&(v=!0),(null===(F=null===(O=null===(W=this.shop.settings)||void 0===W?void 0:W.general)||void 0===O?void 0:O.hide)||void 0===F?void 0:F.price.includes("scheduled"))&&(gt=!0),(null===(V=null===(j=null===(H=this.shop.settings)||void 0===H?void 0:H.general)||void 0===j?void 0:j.hide)||void 0===V?void 0:V.additionalPaymentButton.includes("scheduled"))&&(yt=!0)),At=s.parentElement,["h3","h2","h1"].includes(At.tagName.toLowerCase())&&(At=At.parentElement),v&&At.querySelector(null===(N=null===(Z=null===(R=null===(D=this.shop)||void 0===D?void 0:D.settings)||void 0===R?void 0:R.general)||void 0===Z?void 0:Z.selector)||void 0===N?void 0:N.add_to_cart)&&(At.querySelector(null===(J=null===(Y=null===(G=null===(z=this.shop)||void 0===z?void 0:z.settings)||void 0===G?void 0:G.general)||void 0===Y?void 0:Y.selector)||void 0===J?void 0:J.add_to_cart).style.display="none"),gt&&At.querySelector(null===(X=null===(Q=null===(K=null===(U=this.shop)||void 0===U?void 0:U.settings)||void 0===K?void 0:K.general)||void 0===Q?void 0:Q.selector)||void 0===X?void 0:X.price)&&(At.querySelector(null===(et=null===(it=null===(tt=null===($=this.shop)||void 0===$?void 0:$.settings)||void 0===tt?void 0:tt.general)||void 0===it?void 0:it.selector)||void 0===et?void 0:et.price).style.display="none"),yt&&At.querySelector(null===(st=null===(lt=null===(ot=null===(nt=this.shop)||void 0===nt?void 0:nt.settings)||void 0===ot?void 0:ot.general)||void 0===lt?void 0:lt.selector)||void 0===st?void 0:st.payment_button)&&(At.querySelector(null===(ct=null===(ut=null===(at=null===(rt=this.shop)||void 0===rt?void 0:rt.settings)||void 0===at?void 0:at.general)||void 0===ut?void 0:ut.selector)||void 0===ct?void 0:ct.payment_button).style.display="none"),wt&&!wt.winnerAuction&&(null===(pt=null===(vt=null===(dt=this.shop.settings)||void 0===dt?void 0:dt.general)||void 0===vt?void 0:vt.collection)||void 0===pt?void 0:pt.enabled)&&(St=(0,l.Ao)(d({},f(null==t?void 0:t.config)),i,null==wt?void 0:wt.currentAmount),null==t||t.end_at,It=(0,l.zR)(t,i.id),Lt=It.endAt,document.querySelector(".tpa-auction-collection-template")&&(bt=document.querySelector(".tpa-auction-collection-template").innerHTML),Ct=o.Z.render(bt,d(d({},t),{profileConfig:St,summary:wt,endAt:Lt,status:_t,configuration:this.shop.configuration,settings:this.shop.settings,productId:i.id,customer:null==this?void 0:this.customer})),xt=o.Z.render(n.Z,{settings:this.shop.settings}),(qt=document.createElement("DIV")).classList.add("tpa-collection-widget"),qt.setAttribute("data-productId",i.id),qt.setAttribute("data-profileId",t.id),qt.innerHTML=Ct,qt.innerHTML+=xt,(Pt=At.querySelector(".tpa-collection-widget"))&&Pt.remove(),At.style.position="relative",a?At.style.position="relative":(At=s).parentElement.style.position="relative",At.appendChild(qt),0!=_t&&("textClock"!=(null===(mt=null===(ft=null===(ht=this.shop)||void 0===ht?void 0:ht.settings)||void 0===ft?void 0:ft.general)||void 0===mt?void 0:mt.countdown)?1==_t?(0,l.gr)(Lt,qt):(0,l.gr)(null==t?void 0:t.start_at,qt):1==_t?this.tpaIntervalIds.push({id:(0,l.gV)(Lt,qt),idProduct:i.id}):this.tpaIntervalIds.push({id:(0,l.gV)(null==t?void 0:t.start_at,qt),idProduct:i.id}))),[2]}))}))},initWidgetCollection:function(){return v(this,void 0,void 0,(function(){var t,i,e,n,o,s=this;return p(this,(function(a){return t=document.querySelectorAll(".tpa-collection-widget .tpa-auction-amount"),i=document.querySelectorAll(".tpa-collection-widget .tpa-auction-bid button"),e=document.querySelectorAll(".tpa-collection-widget .tpa-plus-amount"),n=document.querySelectorAll(".tpa-collection-widget .tpa-minus-amount"),o=document.querySelectorAll(".tpa-collection-widget .tpa-auction-automatic-amount"),!(null==this?void 0:this.customer)&&t&&t.forEach((function(t){return v(s,void 0,void 0,(function(){var i=this;return p(this,(function(e){return t.disabled=!0,o&&o.forEach((function(t){return v(i,void 0,void 0,(function(){return p(this,(function(i){return t.disabled=!0,[2]}))}))})),[2]}))}))})),t&&t.forEach((function(t){return v(s,void 0,void 0,(function(){return p(this,(function(i){return t.addEventListener("change",(function(i){var e=(0,l.rI)(t.value);t.value=(0,l.lb)(100*e,null,!0)})),[2]}))}))})),i&&i.forEach((function(t){return v(s,void 0,void 0,(function(){var i=this;return p(this,(function(e){return t.addEventListener("click",(function(e){return v(i,void 0,void 0,(function(){var i,n,o,s,a,u,v,h,f,m,g,y,b,_,w,A,S,L,I,C,x,q,P,T;return p(this,(function(p){switch(p.label){case 0:return e.preventDefault(),(null==this?void 0:this.customer)?(i=void 0,n=void 0,o=t.closest(".tpa-collection-widget"),s=o.getAttribute("data-productId"),a=o.getAttribute("data-profileId"),u=o.querySelector(".tpa-auction-amount"),v=o.querySelector(".tpa-auction-automatic-bid button"),(null===(I=null===(L=this.shop.settings.general)||void 0===L?void 0:L.confirmationDialog)||void 0===I?void 0:I.enabled)&&(h=(0,l.Iu)("ppMessageCustomerBid_areSureYouWantToBid",""),1!=confirm(h))?[2,!1]:(t.disabled=!0,t.querySelector(".tpa-button-text").classList.add("is-close"),t.querySelector(".tpa-button-loading").classList.add("is-open"),this.ToastWidget.classList.remove("open"),f=!1,(null===(C=null==this?void 0:this.AuctionCollectionsProducts)||void 0===C?void 0:C.length)>0&&(i=this.AuctionCollectionsProducts.find((function(t){return!(!a||(null==t?void 0:t.id)!=a)}))),(null===(q=null===(x=null==i?void 0:i.config)||void 0===x?void 0:x.penny)||void 0===q?void 0:q.enabled)?[4,(0,r.V)({customerId:null===(P=null==this?void 0:this.customer)||void 0===P?void 0:P.id,email:null===(T=null==this?void 0:this.customer)||void 0===T?void 0:T.email,productId:s,profileId:i.id,shopId:this.shop.id})]:[3,2])):[3,3];case 1:n=p.sent(),p.label=2;case 2:if(m=this.checkCustomerIsLoggedCollection(o,n,!0),g=this.ObjectCollections.find((function(t){return t.id==s})),m&&g){if(y=(0,l.rI)(u.value),b=y,_=this.validPriceCollection(!0,"",s,a),null==g?void 0:g.variants.find((function(t){return t.available})),w=g.images.find((function(t){return t.src})),A=null==g?void 0:g.variants.find((function(t){return!0})),!y||_>0&&_>y)return t.disabled=!1,t.querySelector(".tpa-button-text").classList.remove("is-close"),t.querySelector(".tpa-button-loading").classList.remove("is-open"),this.showMessageCollection("",(0,l.Iu)("pleaseInsertAValidBidAmount",""),"warning"),[2,!1];v&&(v.disabled=!0),S={autoBid:f,auto_bid_amount:b,amount:y,profileId:a,customer:null==this?void 0:this.customer,product:d(d({},g),{selectedVariant:A,featured_image:null==w?void 0:w.src}),url:this.shop.url},this.socketCollection.emit("bid",S)}else t.disabled=!1,t.querySelector(".tpa-button-text").classList.remove("is-close"),t.querySelector(".tpa-button-loading").classList.remove("is-open");return[3,4];case 3:c.Z.buildWidget(),this.modalLogin=document.querySelector(".tpa-modalLogin-wrapper"),this.modalLogin.querySelector(".tpa-modalLogin-widget_info").classList.add("is-open"),p.label=4;case 4:return[2]}}))}))})),[2]}))}))})),e&&e.forEach((function(t){return v(s,void 0,void 0,(function(){var i=this;return p(this,(function(e){return t.addEventListener("click",(function(e){if(e.preventDefault(),!(null==i?void 0:i.customer))return!1;var n=t.closest(".tpa-collection-widget").getAttribute("data-productId"),o=t.closest(".tpa-collection-widget").getAttribute("data-profileId"),s=t.closest(".tpa-your_bid").querySelector(".tpa-auction-amount"),r=(0,l.rI)(s.value);s.value=(0,l.lb)(100*i.validPriceCollection(!0,r,n,o),null,!0)})),[2]}))}))})),n&&n.forEach((function(t){return v(s,void 0,void 0,(function(){var i=this;return p(this,(function(e){return t.addEventListener("click",(function(e){if(e.preventDefault(),!(null==i?void 0:i.customer))return!1;var n=t.closest(".tpa-collection-widget").getAttribute("data-productId"),o=t.closest(".tpa-collection-widget").getAttribute("data-profileId"),s=t.closest(".tpa-your_bid").querySelector(".tpa-auction-amount"),r=(0,l.rI)(s.value);s.value=(0,l.lb)(100*i.validPriceCollection(!1,r,n,o),null,!0)})),[2]}))}))})),[2]}))}))},checkCustomerIsLoggedCollection:function(t,i,e){var n,o=!0;if(null===(n=null==this?void 0:this.customer)||void 0===n?void 0:n.email){if(i&&!(null==i?void 0:i.isInPenneyProduct)&&!(null==i?void 0:i.unlimited)){clearTimeout(this.tpaTimeoutId),this.ToastWidget.classList.add("open");var s=this.ToastWidget.querySelector(".tpa-auction-message");s.classList.contains("success")&&(s.style.display="none",s.classList.remove("success"));var r=(0,l.Iu)("youHaveNumberAuctionsBuyItHere","");this.showMessageCollection(t,r,"warning",i),e&&s.querySelector(".pennyModal").click(),o=!1}}else o=!1;return o},validPriceCollection:function(t,i,e,n){var o,s,r,a,u,c;r||(a=this.ObjectCollections.find((function(t){return t.id==e&&((r=t.variants.find((function(t){return t.available})))||(r=t.variants.find((function(t){return!0}))),!0)}))),(null===(o=null==this?void 0:this.AuctionCollectionsProducts)||void 0===o?void 0:o.length)>0&&(u=this.AuctionCollectionsProducts.find((function(t){return!(!n||(null==t?void 0:t.id)!=n)}))),(null===(s=null==this?void 0:this.AuctionSummaries)||void 0===s?void 0:s.length)>0&&(c=this.AuctionSummaries.find((function(t){return(null==t?void 0:t.product_id)==e&&(null==t?void 0:t.auction_id)==n})));var v=r,p=(0,l.Ao)(d({},f(u.config)),a,v,i),h=Number.isNaN(parseFloat(i))?(null==c?void 0:c.tpaCurrentPrice)?parseFloat(null==c?void 0:c.tpaCurrentPrice):parseFloat(null==p?void 0:p.startPrice):parseFloat(i);return i?(t?h+=parseFloat(p.increment):h-=parseFloat(p.increment),p.startPrice>=h&&(h=parseFloat(p.increment)),h):h=parseFloat(p.increment)},initSocketCollection:function(){var t,i=this;if(!this.socketCollection){var e={role:"customer",url:this.shop.url,email:null===(t=null==this?void 0:this.customer)||void 0===t?void 0:t.email,collection:!0},n=h("https://auction.tipo.io",{query:e});n.on("new bid",(function(t){return v(i,void 0,void 0,(function(){var i,e=this;return p(this,(function(n){return t.productId&&(i=document.querySelectorAll(".tpa-collection-widget"))&&i.forEach((function(i){return v(e,void 0,void 0,(function(){var e,n,o,s,r,a,u,c,v,h,m,g,y,b,_,w,A,S,L,I;return p(this,(function(p){return e=i.getAttribute("data-productId"),n=i.getAttribute("data-profileId"),e==t.productId&&(r=i.querySelector(".tpa-collection-widget__info .tpa-other-info__start_price .tpa-row__label"),a=i.querySelector(".tpa-collection-widget__info .tpa-other-info__start_price .tpa-row__value"),u=i.querySelector(".tpa-collection-widget__info .tpa-auction-bid button"),c=i.querySelector(".tpa-auction-amount"),v=i.querySelector(".tpa-auction-amount-note .tpa-auction-amount-note-price"),h=i.querySelector(".tpa-auction-automatic-amount"),m=i.querySelector(".tpa-remaining__text__block"),g=i.querySelector(".tpa-label--auction-status-bidPrice"),(null===(S=null==this?void 0:this.customer)||void 0===S?void 0:S.id)&&t.customerId==(null===(L=null==this?void 0:this.customer)||void 0===L?void 0:L.id)?(g.classList.remove("__outbid"),g.classList.add("__Leading"),g.innerHTML=(0,l.Iu)("Leading",""),this.showMessageCollection(i,(0,l.Iu)(t.message,""),"success")):g.classList.contains("__Leading")&&(g.classList.add("__outbid"),g.classList.remove("__Leading"),g.innerHTML=(0,l.Iu)("Outbid","")),u&&(u.disabled=!1,u.querySelector(".tpa-button-text").classList.remove("is-close"),u.querySelector(".tpa-button-loading").classList.remove("is-open")),r&&(r.innerHTML=(0,l.Iu)("currentBid",""),a.innerHTML=(0,l.lb)(100*t.currentAmount)),(null===(I=null==this?void 0:this.AuctionCollectionsProducts)||void 0===I?void 0:I.length)>0&&(o=this.AuctionCollectionsProducts.find((function(t){return!(!n||(null==t?void 0:t.id)!=n)}))),y=this.ObjectCollections.find((function(t){return t.id==e&&((s=t.variants.find((function(t){return t.available})))||(s=t.variants.find((function(t){return!0}))),!0)})),b=s,_=(0,l.Ao)(d({},f(o.config)),y,b,t.currentAmount),t.endTime&&("textClock"==this.shop.settings.general.countdown&&m?((null==this?void 0:this.tpaIntervalIds)?(w=this.tpaIntervalIds.find((function(t){return t.idProduct==e})),clearInterval(null==w?void 0:w.id)):this.tpaIntervalIds=new Array,this.tpaIntervalIds.push({id:(0,l.gV)(t.endTime,i),idProduct:e})):(0,l.gr)(t.endTime,i)),t.currentAmount&&c&&v&&(A=t.currentAmount+parseFloat(_.increment),(0,l.rI)(c.value)<A&&(c.value=(0,l.lb)(100*A,null,!0),v.innerHTML=(0,l.lb)(100*A)),h&&(0,l.rI)(h.value)<A&&(h.value=(0,l.lb)(100*A,null,!0)))),[2]}))}))})),[2]}))}))})),n.on("fail bid",(function(t){if(t.productId){var e=document.querySelectorAll(".tpa-collection-widget");e&&e.forEach((function(e){return v(i,void 0,void 0,(function(){var i,n,o,s;return p(this,(function(r){return(null===(o=null==this?void 0:this.customer)||void 0===o?void 0:o.id)&&t.customerId==(null===(s=null==this?void 0:this.customer)||void 0===s?void 0:s.id)&&("pennyIsInvalid"!=t.message?this.showMessageCollection(e,(0,l.Iu)(t.message,""),"warning"):this.checkCustomerIsLoggedCollection(e,t.pennies,!1),i=e.querySelector(".tpa-auction-bid button"),n=e.querySelector(".tpa-auction-automatic-bid button"),i.disabled=!1,i.querySelector(".tpa-button-text").classList.remove("is-close"),i.querySelector(".tpa-button-loading").classList.remove("is-open"),n&&(n.disabled=!1,n.querySelector(".tpa-button-text").classList.remove("is-close"),n.querySelector(".tpa-button-loading").classList.remove("is-open"))),[2]}))}))}))}})),n.on("stop bid",(function(t){return v(i,void 0,void 0,(function(){var i,e=this;return p(this,(function(n){return t.productId&&(i=document.querySelectorAll(".tpa-collection-widget"))&&i.forEach((function(i){return v(e,void 0,void 0,(function(){var e,n,o,s,r,u,c;return p(this,(function(d){return e=i.getAttribute("data-productId"),n=i.getAttribute("data-profileId"),o=i.querySelector(".tpa-label--auction-status-bidPrice"),s=i.querySelector(".tpa-collection-widget__action-group"),r=i.querySelector(".tpa-remaining"),u=i.querySelector(".tpa-collection-widget__info"),(null==t?void 0:t.productId)==e&&(null==t?void 0:t.auctionId)==n&&(u&&u.remove(),s&&s.remove(),r&&r.remove(),i.style.display="block",(null==this?void 0:this.customer)&&(null===(c=null==this?void 0:this.customer)||void 0===c?void 0:c.id)==t.customerId?("product"!=this.page&&(a.Z.buildWidget(t,null==this?void 0:this.customer,this.shop),this.modalStopBid=document.querySelector(".tpa-stopModal-wrapper"),this.modalStopBid.querySelector(".tpa-stopModal-widget_info").classList.add("is-open")),(o.classList.contains("__Leading")||o.classList.contains("__outbid"))&&(o.classList.remove("__outbid"),o.classList.remove("__Leading"),o.classList.add("__Won"),o.innerHTML=(0,l.Iu)("Won",""))):(o.classList.contains("__Leading")||o.classList.contains("__outbid"))&&(o.classList.remove("__outbid"),o.classList.remove("__Leading"),o.classList.add("__Lost"),o.innerHTML=(0,l.Iu)("Lost",""))),[2]}))}))})),[2]}))}))})),n.on("stop auction",(function(t){return v(i,void 0,void 0,(function(){var i,e=this;return p(this,(function(n){return(i=document.querySelectorAll(".tpa-collection-widget"))&&i.forEach((function(i){return v(e,void 0,void 0,(function(){var e,n,o,s,r,a,u;return p(this,(function(c){return e=i.getAttribute("data-productId"),n=i.getAttribute("data-profileId"),(null==t?void 0:t.stopAuction)&&n==(null==t?void 0:t.auctionId)&&!(null==t?void 0:t.startingProducts.includes(e))&&(i.style.display="block",o=i.querySelector(".tpa-collection-widget__action-group"),s=i.querySelector(".tpa-label--pending--auction"),r=i.querySelector(".tpa-remaining"),a=i.querySelector(".tpa-product-widget__status"),u=i.querySelector(".tpa-collection-widget__info .tpa-other-info__start_price .tpa-row__label"),s&&s.remove(),o&&o.remove(),a&&a.classList.remove("__yourBidToLow")&&a.classList.remove("__outbid")&&a.classList.add("__stopBidding"),u.innerHTML=(0,l.Iu)("finalBid",""),r.innerHTML='<div class="tpa-remaining__text__label tpa-text tpa-text--small tpa-text--grey">\n\t\t\t\t\t\t\t\t'+(0,l.Iu)("closedForBidding","")+"\n\t\t\t\t\t\t\t</div>"),[2]}))}))})),[2]}))}))})),this.socketCollection=n}},showMessageCollection:function(t,i,e,n){var o=this;clearTimeout(this.tpaTimeoutId),this.ToastWidget.classList.add("open");var l=this.ToastWidget,s=this.ToastWidget.querySelector(".tpa-auction-message");s.innerHTML="",s.innerHTML='<div class="content">'+i+'</div><div class="dismiss"><svg viewBox="0 0 20 20" class="" focusable="false" aria-hidden="true"><path d="M11.414 10l4.293-4.293a.999.999 0 1 0-1.414-1.414L10 8.586 5.707 4.293a.999.999 0 1 0-1.414 1.414L8.586 10l-4.293 4.293a.999.999 0 1 0 1.414 1.414L10 11.414l4.293 4.293a.997.997 0 0 0 1.414 0 .999.999 0 0 0 0-1.414L11.414 10z" fill-rule="evenodd"></path></svg></div>',s.classList.add("open"),"warning"==e&&s.classList.remove("success"),s.classList.add(e),s.style.display="flex",s.querySelector(".dismiss").addEventListener("click",(function(t){s.classList.remove("open"),s.classList.remove(e),s.style.display="none",l.classList.remove("open"),s.innerHTML=""})),s.querySelector(".pennyModal")&&(u.Z.buildWidget(n),s.querySelector(".pennyModal").addEventListener("click",(function(t){t.preventDefault(),o.modalPenny=document.querySelector(".tpa-pennyModal-wrapper"),o.modalPenny.querySelector(".tpa-pennyModal-widget_info").classList.add("is-open")}))),this.tpaTimeoutId=setTimeout((function(){s.classList.remove("open"),s.classList.remove(e),s.style.display="none",l.classList.remove("open"),s.innerHTML=""}),5e3)},getCollectionIds:function(t,i){return v(this,void 0,void 0,(function(){var e,n,o,l=this;return p(this,(function(s){switch(s.label){case 0:return n=new Array,o=new Array,t?(t.forEach((function(t){var i=t.getAttribute("data-id");if(i&&-1===o.indexOf(i)){var e=null==l?void 0:l.Collections[i];n.push(e.handle),o.push(i)}})),o=o.map((function(t){return'id:"'+t+'"'})),n=n.map((function(t){return'handle:"'+t+'"'})),e=n.concat(o)):i&&(i.forEach((function(t){return v(l,void 0,void 0,(function(){var i,e;return p(this,(function(o){return i=t.href,e=i.split("/products/")[1],"product"==this.page&&(e=e.split("?")[0]),void 0!==e&&e&&-1===n.indexOf(e)&&n.push(e),[2]}))}))})),e=n=n.map((function(t){return'handle:"'+t+'"'}))),[4,(d={q:e.join(" OR "),type:"product",view:"tipoAuctionsJson"},r=void 0,a=void 0,u=void 0,c=function(){var t;return function(t,i){var e,n,o,l,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return l={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function r(l){return function(r){return function(l){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return s.label++,{value:l[1],done:!1};case 5:s.label++,n=l[1],l=[0];continue;case 7:l=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){s=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){s.label=l[1];break}if(6===l[0]&&s.label<o[1]){s.label=o[1],o=l;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(l);break}o[2]&&s.ops.pop(),s.trys.pop();continue}l=i.call(t,s)}catch(t){l=[6,t],n=0}finally{e=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,r])}}}(this,(function(i){switch(i.label){case 0:return t=new URLSearchParams(d),[4,fetch("/search?"+t.toString(),{method:"GET"}).then((function(t){return t.json()})).catch((function(){return!1}))];case 1:return[2,i.sent()]}}))},new(u||(u=Promise))((function(t,i){function e(t){try{o(c.next(t))}catch(t){i(t)}}function n(t){try{o(c.throw(t))}catch(t){i(t)}}function o(i){var o;i.done?t(i.value):(o=i.value,o instanceof u?o:new u((function(t){t(o)}))).then(e,n)}o((c=c.apply(r,a||[])).next())})))];case 1:return[2,s.sent()]}var r,a,u,c,d}))}))},getSummaries:function(t,i,e){var n;return v(this,void 0,void 0,(function(){var o,r,a=this;return p(this,(function(u){switch(u.label){case 0:return o=new Array,r=new Array,t?t.forEach((function(t){var i,n=t.getAttribute("data-id");if(n){var s=e.find((function(t){return t.id==n}));o.push(n);var u=(0,l.Ai)(d(d({},s),{collections:null==s?void 0:s.collections}),null===(i=a.shop)||void 0===i?void 0:i.pennies,a.auctions);u&&-1===r.indexOf(null==u?void 0:u.id)&&r.push(null==u?void 0:u.id)}})):i&&i.forEach((function(t){var i,n=t.href,s=new Array,u=n.split("/products/")[1];if("product"==a.page&&(u=u.split("?")[0]),void 0!==u&&u&&-1===s.indexOf(u)){s.push(u);var c=e.find((function(t){return t.handle==u}));if(c){var v=c.id;o.push(v);var p=(0,l.Ai)(d(d({},c),{collections:null==c?void 0:c.collections}),null===(i=a.shop)||void 0===i?void 0:i.pennies,a.auctions);p&&-1===r.indexOf(null==p?void 0:p.id)&&r.push(null==p?void 0:p.id)}}})),[4,(0,s.g4)({profileIds:r.join(","),productIds:o.join(","),customerId:null===(n=null==this?void 0:this.customer)||void 0===n?void 0:n.id})];case 1:return[2,u.sent()]}}))}))}}}}]);